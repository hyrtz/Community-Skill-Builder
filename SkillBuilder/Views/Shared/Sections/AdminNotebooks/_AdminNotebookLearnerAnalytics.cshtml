@model SkillBuilder.Models.ViewModels.AdminProfileViewModel

<div class="analytics-container" style="padding:20px; font-family:Inter, sans-serif;">
    <h1 style="font-size:2rem; font-weight:700;">Learners Analytics</h1>
    <p style="color:#666; margin-top:-5px;">Here is all your learners analytics.</p>

    <!-- TOP CARDS -->
    <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:20px; margin-top:20px;">

        <div class="card" style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <div style="font-size:2rem; font-weight:700;">
                @Model.Analytics.TotalLearners
            </div>
            <div style="color:#666;">Total Number of Learners</div>
        </div>

        <div class="card" style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <div style="font-size:2rem; font-weight:700;">
                @Model.Analytics.TopCourses.Sum(c => c.TotalEnroll)
            </div>
            <div style="color:#666;">Total Enrollments</div>
        </div>

        <div class="card" style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <div style="font-size:2rem; font-weight:700;">
                0 <!-- Hardcoded since no data yet -->
            </div>
            <div style="color:#666;">Unenrolled Students</div>
        </div>

        <div class="card" style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <div style="font-size:2rem; font-weight:700;">
                0% <!-- Hardcoded since no data yet -->
            </div>
            <div style="color:#666;">Student Enrollment Rate</div>
        </div>

    </div>

    <!-- LINE CHART -->
    <div style="background:#fff; border-radius:12px; padding:20px; margin-top:25px; box-shadow:0 2px 8px rgba(0,0,0,0.05); height:380px;">
        <h3 style="font-weight:600;">Average Enrollment Based on Top Courses</h3>
        <canvas id="courseLineChart"></canvas>
    </div>

    <!-- LOWER 3 PANELS -->
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:20px; margin-top:25px;">

        <!-- Donut Chart -->
        <div style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <h3 style="font-weight:600;">Gen Z vs. Millennials</h3>

            <canvas id="genDonutChart"></canvas>

            <div style="display:flex; justify-content:center; gap:40px; margin-top:20px;">
                <div style="text-align:center;">
                    <div style="font-size:1.5rem; font-weight:700;">
                        @Model.Analytics.LearnerCharts.GenZ
                    </div>
                    <div style="color:#666;">Gen Z</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-size:1.5rem; font-weight:700;">
                        @Model.Analytics.LearnerCharts.Millennials
                    </div>
                    <div style="color:#666;">Millennials</div>
                </div>
            </div>
        </div>

        <!-- Age Graph (Hardcoded) -->
        <div style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <h3 style="font-weight:600;">Enrollment by Age</h3>
            <canvas id="ageBarChart"></canvas>
        </div>

        <!-- City Table (Hardcoded for now) -->
        <div style="background:#fff; padding:20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);">
            <h3 style="font-weight:600;">Enrollment by City</h3>
            <table style="width:100%; margin-top:10px; border-collapse:collapse;">
                <thead>
                    <tr style="text-align:left; border-bottom:1px solid #eee;">
                        <th style="padding:8px 0;">City</th>
                        <th style="padding:8px 0;">Students Enrolled</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>New York</td>
                        <td style="font-weight:600;">120</td>
                    </tr>
                    <tr>
                        <td>Los Angeles</td>
                        <td style="font-weight:600;">90</td>
                    </tr>
                    <tr>
                        <td>Chicago</td>
                        <td style="font-weight:600;">60</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const lineCtx = document.getElementById('courseLineChart').getContext('2d');
    const courseLabels = @Html.Raw(Json.Serialize(Model.Analytics.LearnerCharts.TopCourseLabels));
    const totalEnrolls = @Html.Raw(Json.Serialize(Model.Analytics.LearnerCharts.TopCourseTotalEnrollments));
    const genZ = @Html.Raw(Json.Serialize(Model.Analytics.LearnerCharts.TopCourseGenZ));
    const millennials = @Html.Raw(Json.Serialize(Model.Analytics.LearnerCharts.TopCourseMillennials));

    new Chart(lineCtx, {
        type: 'line',
        data: {
            labels: courseLabels,
            datasets: [
                { label: "Total Enrollment", data: totalEnrolls, borderWidth: 2, tension: 0.4, pointRadius: 4 },
                { label: "Gen Z", data: genZ, borderWidth: 2, tension: 0.4, pointRadius: 4 },
                { label: "Millennials", data: millennials, borderWidth: 2, tension: 0.4, pointRadius: 4 }
            ]
        },
        options: {
            responsive: true,
            plugins: { legend: { position: 'bottom' } },
            scales: { y: { beginAtZero: true } }
        }
    });

    const donutCtx = document.getElementById('genDonutChart').getContext('2d');
    new Chart(donutCtx, {
        type: 'doughnut',
        data: {
            labels: ["Gen Z", "Millennials"],
            datasets: [{
                data: [
                    @Model.Analytics.LearnerCharts.GenZ,
                    @Model.Analytics.LearnerCharts.Millennials
                ]
            }]
        },
        options: {
            cutout: "60%",
            plugins: { legend: { position: "bottom" } }
        }
    });

    const ageCtx = document.getElementById('ageBarChart').getContext('2d');
    new Chart(ageCtx, {
        type: 'bar',
        data: {
            labels: ["16-20", "21-25", "26-30", "31-35", "36-40"],
            datasets: [{
                label: "Students",
                data: [320, 290, 180, 150, 70],
                borderWidth: 1
            }]
        },
        options: {
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true } }
        }
    });
</script>