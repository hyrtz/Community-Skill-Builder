@model List<SkillBuilder.Models.ViewModels.CourseProgressViewModel>


@{
    // Filter only ongoing courses
    var ongoingCourses = Model?.Where(c => c.ProgressPercentage < 100).ToList();
}

<style>
    .user-progress-section {
        margin-bottom: 4rem;
    }

    .user-progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

        .user-progress-header h2 {
            font-size: 1.6rem;
            font-weight: bold;
            color: #111;
        }

        .user-progress-header a {
            font-size: 0.95rem;
            font-weight: 500;
            color: #344AEA;
            text-decoration: none;
        }

    .user-progress-card {
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        margin-bottom: 2rem;
        overflow: hidden;
        box-shadow: 0 2px 6px rgba(0,0,0,0.04);
    }

    .user-progress-bar-container {
        background-color: #e6edff;
        height: 14px;
        position: relative;
    }

    .user-progress-bar-fill {
        background-color: #344AEA;
        height: 100%;
        border-top-left-radius: 10px;
        border-bottom-left-radius: 10px;
        text-align: right;
        color: white;
        font-size: 0.75rem;
        line-height: 14px;
        padding-right: 6px;
        font-weight: 600;
    }

    .user-progress-card-content {
        padding: 1.5rem;
    }

        .user-progress-card-content h4 {
            margin: 0;
            font-size: 1.1rem;
            color: #222;
            font-weight: 700;
        }

        .user-progress-card-content small {
            display: block;
            font-size: 0.85rem;
            font-weight: bold;
            color: #999;
            margin-bottom: 0.5rem;
        }

        .user-progress-card-content p {
            font-size: 0.95rem;
            color: #444;
            margin-top: 0.5rem;
        }

    .user-progress-resume-button {
        background-color: #344AEA;
        color: white;
        width: 100%;
        text-align: center;
        padding: 1rem;
        font-weight: 600;
        font-size: 1rem;
        border: none;
        cursor: pointer;
        transition: background 0.2s;
    }

        .user-progress-resume-button:hover {
            background-color: #1f36b6;
        }

    .user-progress-unpublished-button {
        background-color: #e74c3c; /* red */
        color: white;
        width: 100%;
        text-align: center;
        padding: 1rem;
        font-weight: 600;
        font-size: 1rem;
        border: none;
        cursor: not-allowed;
        opacity: 0.9;
    }
</style>

@if (ongoingCourses != null && ongoingCourses.Any())
{
    <section class="user-progress-section">
        <div class="user-progress-header">
            <h2>Keep Learning</h2>
        </div>

        @foreach (var course in ongoingCourses)
        {
            var progress = Math.Round(course.ProgressPercentage, 0);
            <div class="user-progress-card">
                <!-- Course Info -->
                <div class="user-progress-card-content">
                    <small>Course</small>
                    <h4>@course.CourseTitle</h4>
                    <p>@course.CourseDescription</p>
                </div>

                <!-- Resume / Unpublished Button -->
                @if (course.IsPublished)
                {
                    <form asp-controller="Courses" asp-action="CourseModule" asp-route-id="@course.CourseId" method="get">
                        <button type="submit" class="user-progress-resume-button">Resume</button>
                    </form>
                }
                else
                {
                    <button type="button" class="user-progress-unpublished-button" disabled>
                        This course is currently unpublished
                    </button>
                }
            </div>
        }
    </section>
}